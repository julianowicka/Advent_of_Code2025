
const INPUT = `
......................................................................S......................................................................
.............................................................................................................................................
......................................................................^......................................................................
.............................................................................................................................................
.....................................................................^.^.....................................................................
.............................................................................................................................................
....................................................................^...^....................................................................
.............................................................................................................................................
...................................................................^.^.^.^...................................................................
.............................................................................................................................................
..................................................................^.^.....^..................................................................
.............................................................................................................................................
.................................................................^.^.^.^.^.^.................................................................
.............................................................................................................................................
................................................................^.^.......^.^................................................................
.............................................................................................................................................
...............................................................^.^.^...^.^.^.^...............................................................
.............................................................................................................................................
..............................................................^.^.^.^.^.^.^...^..............................................................
.............................................................................................................................................
.............................................................^.^.^...^.......^.^.............................................................
.............................................................................................................................................
............................................................^.^.....^.^.^.^.^.^.^............................................................
.............................................................................................................................................
...........................................................^.^...^.^...^.^...^...^...........................................................
.............................................................................................................................................
..........................................................^.^...^...^...^.^...^.^.^..........................................................
.............................................................................................................................................
.........................................................^.^.^.^.^.^.....^.^.^...^.^.........................................................
.............................................................................................................................................
........................................................^.^...^...^.^...^.^.^.^...^.^........................................................
.............................................................................................................................................
.......................................................^.^.^...^.^...^.^...^.^.^.....^.......................................................
.............................................................................................................................................
......................................................^.^...^...^.^.^.^.^.^...^.^.^...^......................................................
.............................................................................................................................................
.....................................................^.^.^.^.^.^...^.^.^...^.........^.^.....................................................
.............................................................................................................................................
....................................................^...^...^.....^.....^.^.^.^.....^.^.^....................................................
.............................................................................................................................................
...................................................^...^.^.^.......^...^.....^.^.^...^.^.^...................................................
.............................................................................................................................................
..................................................^.....^.^.^.^.^.^.^.^.^...^...^.^.^.^...^..................................................
.............................................................................................................................................
.................................................^.^.^...^.^.^.....^.^.^.^.....^...^.^.^.^.^.................................................
.............................................................................................................................................
................................................^.^.....^.^...^.^.^...^.....^.^.^.^.^.^...^.^................................................
.............................................................................................................................................
...............................................^.^.^.^.^.^.^...^.^...^.^...^.^...^.^.^.^.^.^.^...............................................
.............................................................................................................................................
..............................................^.^.^.^.^.^...^...^...^...^.^.....^.^.^.^.^...^.^..............................................
.............................................................................................................................................
.............................................^...^.^...^.^.^.......^.^...^.^.^.^.^.^...^.^.....^.............................................
.............................................................................................................................................
............................................^...^.^...^.^.^.....^.....^.^.^.^.^.....^.^.....^...^............................................
.............................................................................................................................................
...........................................^.^.^.^.^.^.^.^.^.....^.^.^.^.^...^...^.^.^...^.....^.^...........................................
.............................................................................................................................................
..........................................^.^...^.^.^.^.^.^.^...^...^.^.^...^.^.^.^.^.^...^...^.^.^..........................................
.............................................................................................................................................
.........................................^.^...^...^.......^.^.^.^.^.....^.^.^...^.^.^.^.^.^...^.^.^.........................................
.............................................................................................................................................
........................................^.....^.^.....^.^...^.^...^.^.^.^...........^...^.^...^...^.^........................................
.............................................................................................................................................
.......................................^.^.^...^.^.^.^.^.^...^.^...^.^.........^.^.^.^.^.^.^.....^.^.^.......................................
.............................................................................................................................................
......................................^.....^.^...........^.^.^.^.......^...^.^.^...^.......^.......^.^......................................
.............................................................................................................................................
.....................................^.^.^.....^.^.^.^.^.....^...^.^.^.^.^...^.^...^.^...^...^...^...^.^.....................................
.............................................................................................................................................
....................................^.^.....^...^.^...^.^.....^.^.^.^.^...^.^...^.^...^.^.^.^...^...^...^....................................
.............................................................................................................................................
...................................^...^.^.^.^...^.^...^...^.......^.^.^.^.....^.^.^...^.^...^.^...^.^...^...................................
.............................................................................................................................................
..................................^...^.......^.^.^.^.^.......^.^.^.............^...^.....^...^.^...^.^.^.^..................................
.............................................................................................................................................
.................................^.^.^.^.......^.....^.^.^...^.....^.....^.^.^.^...^.^...^.^.^...^.......^.^.................................
.............................................................................................................................................
................................^...^.^.^...^.......^...^.^...^...^.^.^.^.^.^.^.....^.^...^.^...^.^...^.^...^................................
.............................................................................................................................................
...............................^...^.....^.^.^...^...........^.^...^.........^.^.^.^.^...^.^.^.^.^...^.^.^.^.^...............................
.............................................................................................................................................
..............................^.^...^.^.......^.....^.^.^.^...^.^.^...^.^...^.^.^...^.^.^.....^...^.^.^...^...^..............................
.............................................................................................................................................
.............................^.^.^...^.^.^...^.^.^.^.^.^.....^...^.^.^...^.....^.^.^.^.^...^...^.^.^.^.^.^.....^.............................
.............................................................................................................................................
............................^.^.^...^.^.^...^.^.....^.^...^.^.^.^...^...^...^.^.^.^.^.^...^.......^.^.^.^.^.^.^.^............................
.............................................................................................................................................
...........................^.^.^.^.^...^...^.^.^.^...^.^.........^.^.^...^.....^.^.^.^...^.^...^.^.....^...^.^.^.^...........................
.............................................................................................................................................
..........................^...^...^.^.^.^.^.^.^.^.^.^.^...^...^...^.^.^.^.^...^.......^.^...^.^.^.^.^.....^.^...^.^..........................
.............................................................................................................................................
.........................^.^...^.^.^.^.^.^...^...^...^.....^...^.^.^.^...^.....^.^...^.^...^...^...^.^.^.^.^...^...^.........................
.............................................................................................................................................
........................^.^...^...^.^...^.^.^.^.^...^.......^...^.^.....^.^.^.....^...^.^.^.^.^.^.^...^.^...^...^.^.^........................
.............................................................................................................................................
.......................^.^.^.^.^.^.^...^.......^...^.^.^.^.^.^...^.^.^...........^.^.^.^...^.^.....^.^.^.^...^.^.^...^.......................
.............................................................................................................................................
......................^.^.....^.^...^.^.....^.^.^...^.^.^.^.^.^...^.^.....^.....^...^.^.^.^.^.^.......^.^.^.^...^.^.^.^......................
.............................................................................................................................................
.....................^.^.^...^.^.^.....^.^.^.^...^...^.^.^.^.^.^.^.^.^.^.^...^.^.........^.^.^.^.^.^.^...^.....^...^...^.....................
.............................................................................................................................................
....................^.......^...^.^.^.^.............^.^.^.^.^...^.^.^.^.^.^.^.^.^.^...^.^.^.^.^.......^...^.^.^.^.^.^.^.^....................
.............................................................................................................................................
...................^.^.^.^.^.............^.^.^.^.^.^.^.^...^.^.^.^...^.^.^.........^.^...^...^.^.^...^.^.^.^...^.^.^...^.^...................
.............................................................................................................................................
..................^...^.^.^...^.^.^...^.^.^.....^.^.^.^.^.^.^.^...^...........^.^.^...^.....^...^.^.^.......^.^.....^.^.^.^..................
.............................................................................................................................................
.................^...^.^...^.....^.^.^...^.^.^.^...^.^.^...^...^.^.^.^.^.^.^.....^.^.^.....^...^...^.^.^...^.^...^.^...^...^.................
.............................................................................................................................................
................^.^.^.^.^.^.^.^...^.......^.^.^.....^.^.^...^.....^.^...^.^.^.......^.^.^.^...^.....^.^...^.^.^.^.......^...^................
.............................................................................................................................................
...............^.^.^.^...^...^.^.^.....^.^.^.^...^.^.^.^.^.^...^.^.^.^...^.^...^.^.^.......^.^.^.^...^.^.^.^.^.^...^.^.^...^.^...............
.............................................................................................................................................
..............^.^...^...^...^...^.^.^.^.^.......^.^.^.^.^...^.....^.^.^.^.......^.^.^.^.^.^.^.^.^...^...^.^.^.^.^.^...^.^...^.^..............
.............................................................................................................................................
.............^.^...^.^.^...^...^.......^.....^.^...^.......^.^.^.^...^.^.^.^...^.^.^.......^.^.......^.^...^.^.^.^.^.^.^.^.^.^.^.............
.............................................................................................................................................
............^.^...^.^.....^.^.^...^.^...^.^.^.......^.^.^.^.^.^.....^...^.....^.^.^...^.^...^...^.^.^.^.......^.......^.^.^.^.^.^............
.............................................................................................................................................
...........^.......^...^...^.....^.^...^.^...^...........^.^.^.^...^.......^...^.^.^.....^.^.....^.....^.^...^.^.^.^.^.^.^.....^.^...........
.............................................................................................................................................
..........^.....^.^.....^.^.^.^.^...^.^...^.^.^.^.^.^.^.^...^.^...^...^.^.^.^.^...^.^.....^.^...^...^...^.....^.^.^.^.^.^.^.^.^.^.^..........
.............................................................................................................................................
.........^.^.^.^.^...^.^...^.^.^...^.^.^...^.^.^.^.^.^.^.^...^.^.^.^.^...^.^.^...^.^...^.^.^.^.^...^...^.^.^.^.....^...^.....^.^.^.^.........
.............................................................................................................................................
........^.^.^...^.^.^.^.^.^.^.^.^.^.....^.....^.^.^.^.^.^...^.^.^.^.^.^.^.^.^.^.....^.^.....^.^.....^.....^...^...^.....^...^.......^........
.............................................................................................................................................
.......^.^.^.^.^.^.....^.^.^.^.^.^.^...^.^...^.....^.^...^.^.^.^.^...^...^.^.^.^.^.^.....^.^...^.....^.^.^.^.^.^.^.^.^...^.^.^...^...^.......
.............................................................................................................................................
......^.^...^.^...^.^.^.^...^...^...^.^...^.......^.^...^.^.^.....^.^.^.^.^.^...^.^...^...^.^...^.^.^.^.^.^.^.^.......^.^.^...^...^...^......
.............................................................................................................................................
.....^.^.^.^.^.^.^.....^.....^.^...^...^.^.^...^...^.^...^.^.^.^...^.^.^.^.^.^.^.....^.^.^...^.^.^.^.......^...^.^.......^.^.^.........^.....
.............................................................................................................................................
....^...^.^.^.^...^.....^...^...^.^.^.^.^.^.^.......^.^.^.^.^.^...^.^.....^.^...^.^.......^.^...^...^.^.^.^...^.^.^.^.......^.^.^.^...^.^....
.............................................................................................................................................
...^.^...^...^.^.^...^.^.^.^.^.^.^.^.^.^.^.^.^.....^.^.^.^.^.^...^...^.^...^.....^.^.....^.^.^...^.^.^.^.^...........^...^...^.^.^.....^.^...
.............................................................................................................................................
..^...........^.^.^.^.^.^.....^...^.^.^.^.^...^.^...^.^.^.^.^.^...^.^...^.^.^...^...^...^.^.^.^.^.^.^...^.^.....^.^.^.^.^.^.^.^.^.^.^.^.^.^..
.............................................................................................................................................
.^...^...^.^.........^...^.^.^.....^...^...^.^.^.^.^...^.^.^.^.^...^.........^.^...^.^.^...^.^.^.^.^...^.^.^.^.^.^.^.....^.....^.....^.^.^.^.
.............................................................................................................................................
`;
function solve() {
    const grid = INPUT.split(/\r?\n/).filter(line => line.trim().length > 0);
    
    if (grid.length === 0) {
        return;
    }

    const height = grid.length;
    const width = grid[0].length;


    let beams = new Set<number>();
    let startRow = -1;

    for (let y = 0; y < height; y++) {
        const x = grid[y].indexOf("S");
        if (x !== -1) {
            beams.add(x);
            startRow = y;
            break;
        }
    }

    if (startRow === -1) {
        return;
    }

    let totalSplits = 0;

    for (let y = startRow + 1; y < height; y++) {
        const nextBeams = new Set<number>();
        const currentRow = grid[y];

        for (const x of beams) {
            if (x >= currentRow.length) continue;

            const char = currentRow[x];

            if (char === "^") {
                totalSplits++;

                if (x - 1 >= 0) {
                    nextBeams.add(x - 1);
                }
                if (x + 1 < width) {
                    nextBeams.add(x + 1);
                }
            } else {
                nextBeams.add(x);
            }
        }

        beams = nextBeams;

        if (beams.size === 0) {
            break;
        }
    }

    console.log(`Total splits: ${totalSplits}`);
}

solve();